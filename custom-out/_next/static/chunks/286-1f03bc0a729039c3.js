(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[286],{2850:function(e,t,n){"use strict";var r=n(8520),a=n.n(r),c=n(5893),o=n(7294),s=n(9521),i=n(9886),l=n(4610),u=n(9816),d=n(8653),p=n(4991),h=n(4105),m=(n(3162),n(9892),n(6455)),f=n.n(m);function x(e,t,n,r,a,c,o){try{var s=e[c](o),i=s.value}catch(l){return void n(l)}s.done?t(i):Promise.resolve(i).then(r,a)}function b(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var c=e.apply(t,n);function o(e){x(c,r,a,o,s,"next",e)}function s(e){x(c,r,a,o,s,"throw",e)}o(void 0)}))}}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){w(e,t,n[t])}))}return e}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,a=!1,c=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(i){a=!0,c=i}finally{try{r||null==s.return||s.return()}finally{if(a)throw c}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}t.Z=function(e){var t,n=e.selectedOrganization,r=e.selectedContact,m=e.selectedDepartment,x=e.selectedSector,g=e.selectedIndustry,y=e.selectedBusinesspartner,j=e.globalSearch,P=e.selectedProduct,C=(0,o.useState)([]),T=C[0],S=C[1],E=(0,o.useState)(!0),I=E[0],O=E[1],A=(0,o.useState)({}),N=A[0],L=A[1];(0,o.useEffect)((function(){console.log("Component mounted. checkedItems:",N)}),[]);var D=function(){var e=Object.values(N).length>0&&Object.values(N).every((function(e){return e}));console.log("Before: handleCheckAll. checkedItems:",N);var t={};Q.forEach((function(n){t[n.id]=!e})),console.log("After: handleCheckAll. newCheckedItems:",t),L(t)},R=b(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Object.entries(N).filter((function(e){var t=v(e,2);t[0];return t[1]})).map((function(e){var t=v(e,1)[0];return Number(t)})),t=n.map((function(e){return T[e].Email})).join(", "),console.log(t);case 3:case"end":return e.stop()}}),e)}))),q=b(a().mark((function e(){var n,r,c,o,s,i,l,u;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R();case 2:return e.prev=2,e.next=5,fetch("http://eimsdemo.mannaicorp.com.qa/otcs/cs.exe/api/v1/auth",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({username:"admin",password:"P@ssw0rd"})});case 5:if(!(n=e.sent).ok){e.next=38;break}return e.next=9,n.json();case 9:if(r=e.sent,c=t.replace(/,\s+/g,",")){e.next=14;break}return f().fire({icon:"warning",title:"Warning",text:"Please select at least one item."}),e.abrupt("return");case 14:return console.log("EmailList:",c),e.next=17,fetch("http://eimsdemo.mannaicorp.com.qa/otcs/cs.exe/api/v1/webreports/1874804?Format=webreport&EmailList=".concat(encodeURIComponent(c)),{method:"GET",headers:{OTCSTicket:r.ticket}});case 17:if(!(o=e.sent).ok){e.next=35;break}return e.next=21,o.blob();case 21:s=e.sent,console.log(s),i=window.URL.createObjectURL(s),console.log(i),l=document.createElement("a"),u=o.headers.get("Content-Type"),l.href=i,l.download="EmployeeList.xls",l.type=u,document.body.appendChild(l),l.click(),window.URL.revokeObjectURL(i),e.next=36;break;case 35:console.error(" Downlaod API failed");case 36:e.next=39;break;case 38:console.error("Authentication API failed");case 39:e.next=44;break;case 41:e.prev=41,e.t0=e.catch(2),console.error("API request failed:",e.t0);case 44:return e.prev=44,O(!1),e.finish(44);case 47:case"end":return e.stop()}}),e,null,[[2,41,44,47]])}))),U=b(a().mark((function e(){var n,r,c,o,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R();case 2:return e.prev=2,e.next=5,fetch("http://eimsdemo.mannaicorp.com.qa/otcs/cs.exe/api/v1/auth",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({username:"admin",password:"P@ssw0rd"})});case 5:if(!(n=e.sent).ok){e.next=25;break}return e.next=9,n.json();case 9:return r=e.sent,c=t.replace(/,\s+/g,","),e.next=13,fetch("http://eimsdemo.mannaicorp.com.qa/otcs/cs.exe/api/v1/webreports/1874804?Format=webreport&EmailList=".concat(encodeURIComponent(c)),{method:"GET",headers:{OTCSTicket:r.ticket}});case 13:if(!(o=e.sent).ok){e.next=22;break}return e.next=17,o.blob();case 17:return s=e.sent,console.log(s),e.abrupt("return",s);case 22:throw new Error("Download API failed");case 23:e.next=26;break;case 25:throw new Error("Authentication API failed");case 26:e.next=32;break;case 28:throw e.prev=28,e.t0=e.catch(2),console.error("Download file error:",e.t0),e.t0;case 32:case"end":return e.stop()}}),e,null,[[2,28]])}))),G=b(a().mark((function e(t,n){var r,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,"recipient-email@example.com","Subject of the email",(r=new FormData).append("attachments",t,n),console.log(r),c="mailto:".concat("recipient-email@example.com","?subject=").concat(encodeURIComponent("Subject of the email"),"&body=Please find the attached file.&attachments=").concat(r),window.location.href=c,console.log("Email screen opened with attachment"),e.next=15;break;case 11:throw e.prev=11,e.t0=e.catch(0),console.error("Error opening email client:",e.t0.message),e.t0;case 15:case"end":return e.stop()}}),e,null,[[0,11]])}))),H=b(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,U();case 3:t=e.sent,"ContactList.xls",G(t,"ContactList.xls"),console.log("Email screen opened with attachment"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("Error handling mail icon click:",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])}))),F=b(a().mark((function e(){var n,r,c,o,s,i,l,u;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R();case 2:return e.prev=2,e.next=5,fetch("http://eimsdemo.mannaicorp.com.qa/otcs/cs.exe/api/v1/auth",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({username:"admin",password:"P@ssw0rd"})});case 5:if(!(n=e.sent).ok){e.next=34;break}return e.next=9,n.json();case 9:if(r=e.sent,c=t.replace(/,\s+/g,",")){e.next=14;break}return f().fire({icon:"warning",title:"Warning",text:"Please select at least one item."}),e.abrupt("return");case 14:return e.next=16,fetch("http://eimsdemo.mannaicorp.com.qa/otcs/cs.exe/api/v1/webreports/1874804?Format=webreport&EmailList=".concat(encodeURIComponent(c)),{method:"GET",headers:{OTCSTicket:r.ticket}});case 16:if(!(o=e.sent).ok){e.next=31;break}return e.next=20,o.blob();case 20:return s=e.sent,e.next=23,s.arrayBuffer();case 23:i=e.sent,l=h.ij(i,{type:"array"}),(u=document.createElement("button")).innerText="Print",u.onclick=function(){return Z(l)},document.body.appendChild(u),e.next=32;break;case 31:console.error("Download API failed");case 32:e.next=35;break;case 34:console.error("Authentication API failed");case 35:e.next=40;break;case 37:e.prev=37,e.t0=e.catch(2),console.error("API request failed:",e.t0);case 40:return e.prev=40,O(!1),e.finish(40);case 43:case"end":return e.stop()}}),e,null,[[2,37,40,43]])}))),Z=function(e){var t=window.open("","_blank");t.document.write(h.cW(e,{bookType:"html",bookSST:!0,type:"base64"})),t.document.close(),t.print()},B="",z=b(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("http://eimsdemo.mannaicorp.com.qa/otcs/cs.exe/api/v1/auth",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({username:"admin",password:"P@ssw0rd"})});case 3:if(!(t=e.sent).ok){e.next=12;break}return e.next=7,t.json();case 7:B=e.sent,console.log(JSON.stringify(B.ticket)),console.log("Authentication successful",B),e.next=13;break;case 12:console.error("Authentication failed");case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),console.error("Error occurred while authenticating:",e.t0);case 18:case"end":return e.stop()}}),e,null,[[0,15]])}))),M=b(a().mark((function e(){var t,c,o,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("http://eimsdemo.mannaicorp.com.qa/otcs/cs.exe/api/v1/auth",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({username:"admin",password:"P@ssw0rd"})});case 3:if(!(t=e.sent).ok){e.next=22;break}return e.next=7,t.json();case 7:return c=e.sent,"webreport",e.next=11,fetch("http://eimsdemo.mannaicorp.com.qa/otcs/cs.exe/api/v1/webreports/1676720?Format=".concat("webreport","&selectedOrganization=").concat(n,"&selectedContact=").concat(r,"&selectedDepartment=").concat(m,"&selectedSector=").concat(x,"&selectedIndustry=").concat(g,"&selectedBusinesspartner=").concat(y),{method:"GET",headers:{OTCSTicket:c.ticket}});case 11:if(!(o=e.sent).ok){e.next=19;break}return e.next=15,o.json();case 15:s=e.sent,S(s),e.next=20;break;case 19:console.error("View data API failed");case 20:e.next=23;break;case 22:console.error("Authentication API failed");case 23:e.next=28;break;case 25:e.prev=25,e.t0=e.catch(0),console.error("API request failed:",e.t0);case 28:return e.prev=28,O(!1),e.finish(28);case 31:case"end":return e.stop()}}),e,null,[[0,25,28,31]])})));(0,o.useEffect)((function(){M()}),[n,r,m,x,g,y]),(0,o.useEffect)((function(){b(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,z();case 3:return e.next=5,fetch("http://eimsdemo.mannaicorp.com.qa/otcs/cs.exe/api/v1/webreports/1853021?Format=webreport&globalSearch=".concat(j),{method:"GET",headers:{OTCSTicket:B.ticket}});case 5:if(!(t=e.sent).ok){e.next=15;break}return console.log(t),e.next=10,t.json();case 10:n=e.sent,console.log(n),S(n),e.next=16;break;case 15:console.error("Global search api failed");case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),console.error("GLobal Search api failed:",e.t0);case 21:case"end":return e.stop()}}),e,null,[[0,18]])})))()}),[j]),(0,o.useEffect)((function(){b(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,z();case 3:return e.next=5,fetch(" http://eimsdemo.mannaicorp.com.qa/otcs/cs.exe/api/v1/webreports/1782625?Format=webreport&selectedProduct=".concat(P),{method:"GET",headers:{OTCSTicket:B.ticket}});case 5:if(!(t=e.sent).ok){e.next=15;break}return console.log(t),e.next=10,t.json();case 10:n=e.sent,console.log(n),S(n),e.next=16;break;case 15:console.error("Product Dropdown api failed");case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),console.error("Product Dropdown Api failed:",e.t0);case 21:case"end":return e.stop()}}),e,null,[[0,18]])})))()}),[P]);var _=(0,o.useMemo)((function(){return[{Header:"Contact Name",accessor:"ContactName",sortType:"alphanumeric"},{Header:"Contact Designation",accessor:"ContactDesignation",sortType:"alphanumeric"},{Header:"Mobile",accessor:"Mobile",sortType:"alphanumeric"},{Header:"Email",accessor:"Email",sortType:"alphanumeric"},{Header:"Department",accessor:"Department",sortType:"alphanumeric"},{Header:"Organization Name",accessor:"OrgName",sortType:"alphanumeric"},{Header:"Influential",accessor:"Influential",sortType:"basic"},{Header:"Decision Maker",accessor:"DecisionMaker",sortType:"basic"},{Header:"Introduced By : Relationship Status",accessor:"IntroducedByRelationshipData",sortType:"alphanumeric"}]}),[]),W=(0,s.useTable)({columns:_,data:T,initialState:{pageIndex:0,pageSize:10}},s.useGlobalFilter,s.usePagination),J=W.getTableProps,V=W.getTableBodyProps,K=W.headerGroups,Q=W.page,X=W.prepareRow,Y=W.state,$=Y.pageIndex,ee=(Y.pageSize,Y.globalFilter,W.setGlobalFilter,W.canPreviousPage),te=W.canNextPage,ne=W.pageCount,re=W.gotoPage,ae=W.nextPage,ce=W.previousPage;return I?(0,c.jsx)("div",{children:"Loading..."}):(0,c.jsx)(i.Z,{children:(0,c.jsxs)(l.Z,{children:[(0,c.jsx)(u.Z,{tag:"h5",children:"Contact Listing"}),(0,c.jsx)(d.Z,{className:"mb-2 text-muted",tag:"h6",children:"Overview of the Contact"}),(0,c.jsx)(i.Z,{children:(0,c.jsx)(l.Z,{children:(0,c.jsxs)(d.Z,{className:"mt-2 text-muted",tag:"h6",children:[(0,c.jsx)("span",{className:"reportIcons",onClick:F,children:(0,c.jsx)("i",{className:"bi bi-printer-fill",title:"Printer"})}),(0,c.jsx)("span",{className:"reportIcons",onClick:q,children:(0,c.jsx)("i",{className:"bi bi-download",title:"Download"})}),(0,c.jsx)("span",{className:"reportIcons",onClick:H,children:(0,c.jsx)("i",{className:"bi bi-envelope",title:"Email"})})]})})}),(0,c.jsx)("div",{className:"table-responsive",children:(0,c.jsxs)(p.Z,k({},J(),{className:"mt-3 align-middle",borderless:!0,children:[(0,c.jsx)("thead",{children:K.map((function(e){return(0,c.jsxs)("tr",k({},e.getHeaderGroupProps(),{children:[(0,c.jsx)("th",{children:(0,c.jsx)("input",{type:"checkbox",checked:Object.values(N).length>0&&Object.values(N).every((function(e){return e})),onChange:D,className:"form-check-input"})}),e.headers.map((function(e){return(0,c.jsx)("th",k({},e.getHeaderProps(),{children:e.render("Header")}))}))]}))}))}),(0,c.jsx)("tbody",k({},V(),{children:Q.map((function(e){return X(e),(0,c.jsxs)("tr",k({},e.getRowProps(),{children:[(0,c.jsx)("td",{children:(0,c.jsx)("input",{type:"checkbox",checked:N[e.id]||!1,onChange:function(){return t=e.id,console.log("Before: handleCheckboxChange. checkedItems:",N),void L((function(e){var n=k({},e,w({},t,!e[t]));return console.log("After: handleCheckboxChange. newCheckedItems:",n),n}));var t},className:"form-check-input"})}),e.cells.map((function(e){return(0,c.jsx)("td",k({},e.getCellProps(),{children:e.render("Cell")}))}))]}))}))}))]}))}),(0,c.jsxs)("div",{className:"pagination",children:[(0,c.jsx)("button",{onClick:function(){return re(0)},disabled:!ee,children:"<<"}),(0,c.jsx)("button",{onClick:function(){return ce()},disabled:!ee,children:"<"}),(0,c.jsxs)("span",{children:["Page"," ",(0,c.jsxs)("strong",{children:[$+1," of ",ne]})," "]}),(0,c.jsx)("button",{onClick:function(){return ae()},disabled:!te,children:">"}),(0,c.jsx)("button",{onClick:function(){return re(ne-1)},disabled:!te,children:">>"})]})]})})}},67:function(){},2061:function(){}}]);